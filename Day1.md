# NHZX Winter Round. Day 1

每题满分 100 分，每题有 25 个测试点。
全部使用文件读写，文件名写在每道试题的标题中。

## T1. 摆渡 (rijeka)

在数轴上有 $N$ 个人，他们的起始位置均为整点。他们每个人都要去到数轴上的另一个整点处。
你的大船在 $x=0$ 处。你需要将这些人带到他们该去的地方，然后驾着你的大船去到 $x=M$ 处。试求最短路程。

### 输入 & 输出

输入第一行：$N,M$；
接下来 $N$ 行，每行两个整数，表示一个人的起始位置和目的地。

输出一个整数，表示最短路程。

|SAMPLE INPUT 1|SAMPLE OUTPUT 1|SAMPLE INPUT 2|SAMPLE OUTPUT 2|
|-|-|-|-|
|<pre>2 10<br>2 8<br>6 4</pre>|<pre>14</pre>|<pre>8 15<br>1 12<br>3 1<br>3 9<br>4 2<br>7 13<br>12 11<br>14 11<br>14 13</pre>|<pre>27</pre>|

### 数据范围

$N\le 3\times 10^5,$ $3\le M\le 10^9$.
对于 $40\%$ 的数据， $N ≤ 5000$.

## T2. 平方与立方 (cubes)

已知非负整数 $a,b,k$。考虑集合 $S=\{a,a+1,\ldots,b\}$，该集合的「$k$ 密度」表示的是 $T$ 中元素的个数，其中 $T=\{(x,y)|x^2\in S, y^3\in S, |x^2 - y^3| ≤ k\}$。请求出 $S$ 的 $k$ 密度。

### 输入 & 输出

输入三行，分别表示 $a,b,k$；
输出一行，表示 $k$ 密度。

|SAMPLE INPUT|SAMPLE OUTPUT|
|-|-|
|<pre>1<br>30<br>2</pre>|<pre>3</pre>|

- $x = 1, y = 1, |x^2 - y^3| = |1 - 1| = 0$;
- $x = 3, y = 2, |x^2 - y^3| = |9 - 8| = 1$;
- $x = 5, y = 3, |x^2 - y^3| = |25 - 27| = 2$.

### 数据范围

|测试点编号|$1 ≤ a ≤ b ≤$|$k$|
|-|-|-|-|
|1-6|$10^{18}$|$k = 0$|
|7-12|$1000$|$0 ≤ k ≤ 10$|
|13-16|$10^6$|$0 ≤ k ≤ 10$|
|17-20|$10^9$|$0 ≤ k ≤ 10$|
|21-25|$10^9$|$0 ≤ k ≤ 10^9$|

## T3. 公司进修

某公司有 $n$ 人，编号为 $1\ldots m$，老板的编号为 $1$。的人员组织可用一个小根堆（不一定是二叉堆）来表示，除了老板之外，$i$ 号员工的上司 $p(i)$ 一定满足 $p(i)<i$。

若 $p(x)=y$，我们称 $x$ 号员工是 $y$ 号员工的一级下属，若 $p(p(x))=y$，则称之为二级下属，以此类推。

老板打算确定两个整数 $L,$ $R$，然后派 $L\ldots R$ 号员工外出进修。

在选择 $L$ 和 $R$ 之前，老板收到了 $m$ 条请求，第 $m$ 条请求包含两个整数 $u_j,$ $k_j$，表示希望把 $u_j$ 号员工的至少一个 $k_j$ 级下属参加进修。

请问老板至少要选多少员工（也就是使得 $R-L+1$ 最小）去才能满足所有需求，并给出 $L, R$。

### 输入 & 输出

输入第一行：$n$；第二行：$p(2),p(3),\ldots,p(n)$；第三行：$m$；接下来 $m$ 行：$u_j,$ $k_j$.

输出两个整数 $L,R$。

|SAMPLE INPUT|SAMPLE OUTPUT|
|-|-|
|<pre>7<br>1 1 2 2 3 3<br>3<br>1 1<br>3 1<br>1 2</pre>|<pre>3 6</pre>|
|<pre>10<br>1 2 2 2 1 5 6 4 7<br>10<br>1 4<br>4 1<br>4 1<br>5 2<br>7 1<br>4 1<br>1 2<br>2 1<br>7 1<br>5 2|<pre>5 10
</pre>|

### 数据范围


|测试点编号|$1 ≤ a ≤ b ≤$|$k$|
|-|-|-|-|
|1-8|$10^{18}$|$k = 0$|
|9-14|$1000$|$0 ≤ k ≤ 10$|
|15-19|$10^6$|$0 ≤ k ≤ 10$|
|20-25|$10^9$|$0 ≤ k ≤ 10$|
